# Fanmania Backend Environment Configuration
# Copy this file to .env and fill in your values

# =======================
# APPLICATION SETTINGS
# =======================
APP_ENV=development          # development, staging, production
APP_PORT=8080
APP_HOST=0.0.0.0
APP_NAME=Fanmania API
APP_VERSION=1.0.0

# CORS (comma-separated origins)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080

# =======================
# DATABASE (PostgreSQL)
# =======================
# Local Development
DB_HOST=localhost
DB_PORT=5432
DB_USER=fanmania
DB_PASSWORD=fanmania_dev_password
DB_NAME=fanmania_dev
DB_SSLMODE=disable          # disable, require, verify-ca, verify-full

# Production (Neon/Supabase connection string)
# DATABASE_URL=postgresql://user:password@host:port/database?sslmode=require

# Connection Pool
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# =======================
# REDIS CACHE
# =======================
# Local Development
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Production (Upstash connection string)
# REDIS_URL=redis://default:password@host:port

# Cache TTL (in seconds)
CACHE_CHALLENGE_TTL=86400       # 24 hours
CACHE_LEADERBOARD_TTL=300       # 5 minutes
CACHE_USER_STATS_TTL=600        # 10 minutes

# =======================
# JWT AUTHENTICATION
# =======================
# Generate with: openssl rand -base64 64
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_ACCESS_TOKEN_EXPIRY=15m     # 15 minutes
JWT_REFRESH_TOKEN_EXPIRY=168h   # 7 days

# =======================
# AI SERVICES
# =======================
# Anthropic Claude (for complex challenges)
ANTHROPIC_API_KEY=sk-ant-api...
ANTHROPIC_MODEL=claude-sonnet-4-20250514
ANTHROPIC_MAX_TOKENS=4000

# OpenAI (for simple challenges & moderation)
OPENAI_API_KEY=sk-proj-...
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=2000

# AI Cost Controls
AI_CACHE_ENABLED=true
AI_MAX_REQUESTS_PER_HOUR=1000
AI_RETRY_ATTEMPTS=3

# =======================
# PUSH NOTIFICATIONS (Firebase)
# =======================
FCM_PROJECT_ID=fanmania-app
FCM_CREDENTIALS_PATH=./config/firebase-credentials.json

# Notification rate limits
NOTIFICATION_MAX_PER_USER_HOUR=5
NOTIFICATION_MAX_PER_USER_DAY=20

# =======================
# RATE LIMITING
# =======================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100        # requests per window
RATE_LIMIT_WINDOW=1m           # time window

# Challenge-specific rate limits
CHALLENGE_ATTEMPTS_PER_HOUR=30
CHALLENGE_ATTEMPTS_PER_DAY=100

# =======================
# SECURITY
# =======================
# Password hashing (bcrypt cost)
BCRYPT_COST=12

# API Keys for internal services (if needed)
INTERNAL_API_KEY=internal-service-key-change-this

# =======================
# LOGGING
# =======================
LOG_LEVEL=info                 # debug, info, warn, error
LOG_FORMAT=json                # json, text
LOG_OUTPUT=stdout              # stdout, file, both

# File logging (if LOG_OUTPUT includes file)
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE=100          # MB
LOG_FILE_MAX_BACKUPS=5
LOG_FILE_MAX_AGE=30            # days

# =======================
# MONITORING & OBSERVABILITY
# =======================
# Sentry (error tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# Metrics (if using Prometheus)
METRICS_ENABLED=false
METRICS_PORT=9090

# =======================
# FILE STORAGE (for future use)
# =======================
# Cloudflare R2 / AWS S3
STORAGE_ENDPOINT=https://storage-endpoint.r2.cloudflarestorage.com
STORAGE_ACCESS_KEY=your-access-key
STORAGE_SECRET_KEY=your-secret-key
STORAGE_BUCKET=fanmania-assets
STORAGE_REGION=auto

# =======================
# FEATURE FLAGS
# =======================
FEATURE_AI_GENERATION_ENABLED=true
FEATURE_PUSH_NOTIFICATIONS_ENABLED=true
FEATURE_LEADERBOARD_ENABLED=true
FEATURE_SOCIAL_FEATURES_ENABLED=false    # For future

# =======================
# DEVELOPMENT SETTINGS
# =======================
# Auto-reload on code changes
DEV_AUTO_RELOAD=true

# Debug mode (verbose logging, disable in production)
DEBUG_MODE=true

# API Documentation
SWAGGER_ENABLED=true
SWAGGER_PATH=/docs

# =======================
# PRODUCTION OPTIMIZATIONS
# =======================
# Gzip compression
GZIP_ENABLED=true
GZIP_LEVEL=5

# Request timeout
REQUEST_TIMEOUT=30s

# Graceful shutdown timeout
SHUTDOWN_TIMEOUT=10s

# =======================
# EXTERNAL SERVICES (Optional)
# =======================
# Email service (for future email notifications)
EMAIL_PROVIDER=sendgrid        # sendgrid, mailgun, smtp
EMAIL_API_KEY=
EMAIL_FROM_ADDRESS=noreply@fanmania.app
EMAIL_FROM_NAME=Fanmania

# SMS service (for future SMS notifications)
SMS_PROVIDER=twilio
SMS_ACCOUNT_SID=
SMS_AUTH_TOKEN=
SMS_FROM_NUMBER=

# =======================
# NOTES
# =======================
# 1. Never commit this file with real credentials
# 2. Use environment variables in production (Railway, Fly.io, etc.)
# 3. Rotate secrets regularly
# 4. Use different values for dev/staging/production
# 5. Keep AI API keys secure - they cost money!
